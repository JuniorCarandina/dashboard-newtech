<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard New Tech - Cloud Edition com Relat√≥rios</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; }
        .modal.ativo { display: flex; align-items: center; justify-content: center; }
        .modal-content { background: white; border-radius: 12px; padding: 20px; max-width: 1200px; width: 95%; max-height: 90vh; overflow-y: auto; }
        
        .sync-indicator { position: fixed; top: 20px; right: 20px; padding: 8px 16px; border-radius: 6px; font-size: 12px; z-index: 1001; }
        .sync-success { background: #10b981; color: white; }
        .sync-error { background: #ef4444; color: white; }
        .sync-pending { background: #f59e0b; color: white; }
        
        .csv-upload { border: 2px dashed #3b82f6; border-radius: 8px; padding: 20px; text-align: center; background: #f8fafc; cursor: pointer; transition: all 0.3s ease; }
        .csv-upload:hover { background: #e0f2fe; border-color: #1976d2; }
        .csv-upload.drag-over { background: #bbf7d0; border-color: #059669; }
        
        .fade-in { animation: fadeIn 0.3s ease-in; }
        .fade-out { animation: fadeOut 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }

        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .tab-button { padding: 8px 16px; margin-right: 4px; border-radius: 6px; cursor: pointer; transition: all 0.2s; }
        .tab-button.active { background: #3b82f6; color: white; }
        .tab-button:not(.active) { background: #e5e7eb; color: #6b7280; }
        .tab-button:not(.active):hover { background: #d1d5db; }
        
        .correcao-badge { position: fixed; top: 80px; right: 20px; background: #10b981; color: white; padding: 6px 12px; border-radius: 6px; font-size: 11px; font-weight: bold; z-index: 1000; }
        
        .metric-card { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .metric-card-2 { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .metric-card-3 { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        .metric-card-4 { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
        
        .chart-container { position: relative; height: 300px; }
        .chart-small { position: relative; height: 200px; }
    </style>
</head>
<body class="min-h-screen bg-gray-50">
    <!-- Badge de Corre√ß√µes Aplicadas -->
    <div class="correcao-badge">‚úÖ RELAT√ìRIOS DE PRODUTIVIDADE</div>
    
    <!-- Indicador de Sincroniza√ß√£o -->
    <div id="sync-indicator" class="sync-indicator" style="display: none;"></div>
    
    <div class="max-w-[98vw] mx-auto p-4">
        <!-- Header -->
        <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-3xl font-bold text-gray-900 mb-2">Dashboard New Tech - Cloud Edition</h1>
                    <p class="text-gray-600">Sistema integrado com an√°lises de produtividade e sincroniza√ß√£o autom√°tica</p>
                </div>
                <div class="flex items-center gap-4">
                    <div class="text-sm text-gray-500">
                        <div>√öltima sync: <span id="ultima-sync">--:--</span></div>
                        <div>Intervalo: <span id="intervalo-sync" class="font-medium text-blue-600">10 min</span></div>
                        <div>Status: <span id="status-conexao" class="font-medium">üü¢ Online</span></div>
                    </div>
                    <button onclick="sincronizarManual()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 text-sm">
                        üîÑ Sincronizar
                    </button>
                </div>
            </div>
        </div>

        <!-- Estat√≠sticas Principais -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-6 mb-6">
            <div class="bg-white rounded-lg shadow-sm p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Total de Projetos</p>
                        <p class="text-2xl font-bold text-gray-900" id="total-projetos">0</p>
                    </div>
                    <div class="bg-blue-100 p-3 rounded-full">üìä</div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow-sm p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Conclu√≠dos</p>
                        <p class="text-2xl font-bold text-green-600" id="projetos-concluidos">0</p>
                    </div>
                    <div class="bg-green-100 p-3 rounded-full">‚úÖ</div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow-sm p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Em Andamento</p>
                        <p class="text-2xl font-bold text-yellow-600" id="projetos-andamento">0</p>
                    </div>
                    <div class="bg-yellow-100 p-3 rounded-full">‚è≥</div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow-sm p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Pessoas Ativas</p>
                        <p class="text-2xl font-bold text-purple-600" id="pessoas-ativas">0</p>
                    </div>
                    <div class="bg-purple-100 p-3 rounded-full">üë•</div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow-sm p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Etapa M√©dia</p>
                        <p class="text-2xl font-bold text-blue-600" id="etapa-media">0.0</p>
                    </div>
                    <div class="bg-blue-100 p-3 rounded-full">üìà</div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow-sm p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Prazo M√©dio</p>
                        <p class="text-2xl font-bold text-indigo-600" id="prazo-medio">0 dias</p>
                    </div>
                    <div class="bg-indigo-100 p-3 rounded-full">üìÖ</div>
                </div>
            </div>
        </div>

        <!-- Controles -->
        <div class="bg-white rounded-lg shadow-sm p-4 mb-6">
            <div class="flex flex-wrap gap-3 items-center justify-between">
                <div class="flex flex-wrap items-center gap-3">
                    <select id="filtro-etapa" onchange="renderizarTabela()" class="border border-gray-300 rounded-lg px-3 py-2 text-sm">
                        <option value="todas">Todas as Etapas</option>
                    </select>
                    <select id="filtro-status" onchange="renderizarTabela()" class="border border-gray-300 rounded-lg px-3 py-2 text-sm">
                        <option value="todos">Todos os Status</option>
                        <option value="Em andamento">Em andamento</option>
                        <option value="Conclu√≠do">Conclu√≠do</option>
                        <option value="Pendente">Pendente</option>
                        <option value="Atrasado">Atrasado</option>
                    </select>
                    <select id="filtro-cliente" onchange="renderizarTabela()" class="border border-gray-300 rounded-lg px-3 py-2 text-sm">
                        <option value="todos">Todos os Clientes</option>
                    </select>
                    <select id="filtro-responsavel" onchange="renderizarTabela()" class="border border-gray-300 rounded-lg px-3 py-2 text-sm">
                        <option value="todos">Todos os Respons√°veis</option>
                    </select>
                    <input type="text" id="busca-projeto" placeholder="Buscar projeto..." onkeyup="renderizarTabela()" 
                        class="border border-gray-300 rounded-lg px-3 py-2 text-sm">
                </div>
                <div class="flex gap-2">
                    <button onclick="mostrarRelatorios()" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 text-sm">
                        üìä Relat√≥rios & An√°lises
                    </button>
                    <button onclick="mostrarGerenciamento()" class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 text-sm">
                        ‚öôÔ∏è Gerenciamento
                    </button>
                    <button onclick="mostrarImportacaoCSV()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 text-sm">
                        üìÅ Importar CSV
                    </button>
                    <button onclick="backupDados()" class="bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 text-sm">
                        üíæ Backup
                    </button>
                </div>
            </div>
        </div>

        <!-- Tabela de Projetos -->
        <div class="bg-white rounded-lg shadow-sm overflow-hidden">
            <div class="px-4 py-4 border-b border-gray-200">
                <h2 class="text-xl font-semibold text-gray-900">Projetos (<span id="total-filtrados">0</span>)</h2>
            </div>
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase">Projeto</th>
                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase">Cliente</th>
                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase">Etapa Atual</th>
                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase">Progresso</th>
                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase">Respons√°vel</th>
                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase">Prazo</th>
                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase">Laudo</th>
                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase">A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="tabela-projetos" class="bg-white divide-y divide-gray-200">
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Modal de Relat√≥rios e An√°lises -->
        <div id="modal-relatorios" class="modal">
            <div class="modal-content">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-900">üìä Relat√≥rios e An√°lises de Produtividade</h2>
                    <button onclick="fecharModal('modal-relatorios')" class="text-gray-500 hover:text-gray-700 text-xl">‚ùå</button>
                </div>
                
                <!-- M√©tricas de Produtividade -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="metric-card text-white p-6 rounded-lg">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm opacity-90">üìà Produtividade</p>
                                <p class="text-3xl font-bold" id="produtividade-percent">0%</p>
                                <p class="text-xs opacity-75" id="produtividade-desc">Projetos finalizados</p>
                            </div>
                            <div class="text-4xl opacity-75">üìà</div>
                        </div>
                    </div>
                    
                    <div class="metric-card-2 text-white p-6 rounded-lg">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm opacity-90">‚è±Ô∏è Tempo M√©dio</p>
                                <p class="text-3xl font-bold" id="tempo-medio-valor">0 dias</p>
                                <p class="text-xs opacity-75">Por etapa</p>
                            </div>
                            <div class="text-4xl opacity-75">‚è±Ô∏è</div>
                        </div>
                    </div>
                    
                    <div class="metric-card-3 text-white p-6 rounded-lg">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm opacity-90">‚ö° Efici√™ncia</p>
                                <p class="text-3xl font-bold" id="eficiencia-percent">100%</p>
                                <p class="text-xs opacity-75" id="eficiencia-desc">Cumprimento de prazos</p>
                            </div>
                            <div class="text-4xl opacity-75">‚ö°</div>
                        </div>
                    </div>
                    
                    <div class="metric-card-4 text-white p-6 rounded-lg">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm opacity-90">‚ö†Ô∏è Alertas</p>
                                <p class="text-3xl font-bold" id="alertas-count">0</p>
                                <p class="text-xs opacity-75" id="alertas-desc">Projetos em atraso</p>
                            </div>
                            <div class="text-4xl opacity-75">‚ö†Ô∏è</div>
                        </div>
                    </div>
                </div>

                <!-- Gr√°ficos -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <div class="bg-white p-6 rounded-lg border">
                        <h3 class="font-semibold text-gray-800 mb-4">üìä Projetos por Status</h3>
                        <div class="chart-container">
                            <canvas id="chart-status"></canvas>
                        </div>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg border">
                        <h3 class="font-semibold text-gray-800 mb-4">üìà Projetos por Etapa</h3>
                        <div class="chart-container">
                            <canvas id="chart-etapas"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Gr√°ficos de Linha -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <div class="bg-white p-6 rounded-lg border">
                        <h3 class="font-semibold text-gray-800 mb-4">üìÖ Timeline de Projetos</h3>
                        <div class="chart-container">
                            <canvas id="chart-timeline"></canvas>
                        </div>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg border">
                        <h3 class="font-semibold text-gray-800 mb-4">üë• Carga de Trabalho por Respons√°vel</h3>
                        <div class="chart-container">
                            <canvas id="chart-responsaveis"></canvas>
                        </div>
                    </div>
                </div>

                <!-- An√°lise Detalhada -->
                <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-lg">
                    <h3 class="font-semibold text-gray-800 mb-4">üîç An√°lise Detalhada (Engenharia de Produ√ß√£o)</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                        <div>
                            <h4 class="font-medium text-gray-700 mb-2">üìä Como calculamos a Produtividade:</h4>
                            <ul class="text-gray-600 space-y-1 text-xs">
                                <li>‚Ä¢ <strong>Produtividade:</strong> (Projetos Conclu√≠dos / Total de Projetos) √ó 100%</li>
                                <li>‚Ä¢ <strong>Taxa de Conclus√£o:</strong> Baseada no status "Conclu√≠do"</li>
                                <li>‚Ä¢ <strong>Meta Padr√£o:</strong> 85% de produtividade mensal</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-medium text-gray-700 mb-2">‚è±Ô∏è Como calculamos o Tempo M√©dio:</h4>
                            <ul class="text-gray-600 space-y-1 text-xs">
                                <li>‚Ä¢ <strong>Por Etapa:</strong> (Data Atual - Data Cria√ß√£o) / Etapa Atual</li>
                                <li>‚Ä¢ <strong>Apenas projetos ativos:</strong> Status ‚â† "Conclu√≠do"</li>
                                <li>‚Ä¢ <strong>Peso das etapas:</strong> Considera complexidade real</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-medium text-gray-700 mb-2">‚ö° Como calculamos a Efici√™ncia:</h4>
                            <ul class="text-gray-600 space-y-1 text-xs">
                                <li>‚Ä¢ <strong>No Prazo:</strong> Projetos dentro do prazo / Total ativos</li>
                                <li>‚Ä¢ <strong>Conclu√≠dos:</strong> Sempre considerados eficientes</li>
                                <li>‚Ä¢ <strong>Meta Ideal:</strong> 95% de efici√™ncia</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-medium text-gray-700 mb-2">‚ö†Ô∏è Como calculamos os Alertas:</h4>
                            <ul class="text-gray-600 space-y-1 text-xs">
                                <li>‚Ä¢ <strong>Projetos Atrasados:</strong> Prazo vencido + n√£o conclu√≠do</li>
                                <li>‚Ä¢ <strong>Urgentes:</strong> 1-3 dias para vencer</li>
                                <li>‚Ä¢ <strong>Pr√≥ximos:</strong> 4-7 dias para vencer</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal de Gerenciamento do Sistema -->
        <div id="modal-gerenciamento" class="modal">
            <div class="modal-content">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold text-gray-900">‚öôÔ∏è Gerenciamento do Sistema</h2>
                    <button onclick="fecharModal('modal-gerenciamento')" class="text-gray-500 hover:text-gray-700 text-xl">‚ùå</button>
                </div>
                
                <!-- Tabs do Gerenciamento -->
                <div class="flex border-b border-gray-200 mb-6">
                    <button class="tab-button active" onclick="mostrarTab('projetos-tab')">Projetos</button>
                    <button class="tab-button" onclick="mostrarTab('clientes-tab')">Clientes</button>
                    <button class="tab-button" onclick="mostrarTab('funcionarios-tab')">Funcion√°rios</button>
                    <button class="tab-button" onclick="mostrarTab('etapas-tab')">Etapas</button>
                    <button class="tab-button" onclick="mostrarTab('importar-tab')">Importar</button>
                    <button class="tab-button" onclick="mostrarTab('backup-tab')">Backup</button>
                </div>

                <!-- Projetos Tab -->
                <div id="projetos-tab" class="tab-content active">
                    <div class="mb-4">
                        <button onclick="novorProjeto()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 text-sm">
                            ‚ûï Novo Projeto
                        </button>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-2 text-left">Nome</th>
                                    <th class="px-4 py-2 text-left">Cliente</th>
                                    <th class="px-4 py-2 text-left">Status</th>
                                    <th class="px-4 py-2 text-left">Prazo</th>
                                    <th class="px-4 py-2 text-left">A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody id="tabela-gerenciamento-projetos">
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Outras tabs (placeholder) -->
                <div id="clientes-tab" class="tab-content">
                    <h3 class="font-semibold mb-4">Gerenciar Clientes</h3>
                    <p class="text-gray-600">Funcionalidade em desenvolvimento...</p>
                </div>

                <div id="funcionarios-tab" class="tab-content">
                    <h3 class="font-semibold mb-4">Gerenciar Funcion√°rios</h3>
                    <p class="text-gray-600">Funcionalidade em desenvolvimento...</p>
                </div>

                <div id="etapas-tab" class="tab-content">
                    <h3 class="font-semibold mb-4">Gerenciar Etapas</h3>
                    <div class="space-y-2" id="lista-etapas">
                    </div>
                </div>

                <div id="importar-tab" class="tab-content">
                    <h3 class="font-semibold mb-4">Importar Dados</h3>
                    <p class="text-gray-600">Funcionalidade em desenvolvimento...</p>
                </div>

                <div id="backup-tab" class="tab-content">
                    <h3 class="font-semibold mb-4">Backup e Restaura√ß√£o</h3>
                    <p class="text-gray-600">Funcionalidade em desenvolvimento...</p>
                </div>
            </div>
        </div>

        <!-- Modal de Importa√ß√£o CSV -->
        <div id="modal-csv" class="modal">
            <div class="modal-content">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold text-gray-900">üìÅ Importar CSV do NewTech v25</h2>
                    <button onclick="fecharModal('modal-csv')" class="text-gray-500 hover:text-gray-700 text-xl">‚ùå</button>
                </div>
                
                <div class="space-y-4">
                    <div class="csv-upload" id="csv-upload-area" onclick="document.getElementById('csv-file-input').click()">
                        <div class="text-center">
                            <div class="text-4xl mb-2">üìÑ</div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-2">Selecione o arquivo CSV</h3>
                            <p class="text-sm text-gray-500 mb-4">Arraste e solte ou clique para selecionar</p>
                            <input type="file" id="csv-file-input" accept=".csv" style="display: none;" onchange="processarCSV(this.files[0])">
                            <button type="button" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 text-sm">
                                üìÅ Escolher Arquivo
                            </button>
                        </div>
                    </div>

                    <div id="csv-preview" style="display: none;">
                        <h3 class="font-semibold text-gray-800 mb-2">üëÅÔ∏è Pr√©via da Importa√ß√£o</h3>
                        <div id="csv-preview-content" class="bg-gray-50 p-3 rounded border max-h-48 overflow-y-auto"></div>
                        <div class="flex gap-2 mt-4">
                            <button onclick="confirmarImportacaoCSV()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 text-sm">
                                ‚úÖ Confirmar Importa√ß√£o
                            </button>
                            <button onclick="cancelarImportacaoCSV()" class="bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 text-sm">
                                ‚ùå Cancelar
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== CONFIGURA√á√ÉO E DADOS GLOBAIS ====================
        
        let configAPI = {
            url: 'http://localhost:8080/api',
            token: 'newtech-token-2025',
            syncAuto: true,
            intervaloMinutos: 10,
            ultimaSync: null
        };

        // Sistema de etapas com PESOS CORRETOS baseado em Engenharia de Produ√ß√£o
        let etapasProcesso = [
            { id: 1, nome: "Pedido Fechado", peso: 2, tempoMedio: 1, categoria: "Comercial" },
            { id: 2, nome: "Projeto Mec√¢nico e El√©trico", peso: 5, tempoMedio: 3, categoria: "Desenvolvimento" },
            { id: 3, nome: "Aprova√ß√£o do Cliente", peso: 3, tempoMedio: 2, categoria: "Comercial" },
            { id: 4, nome: "Elaborar Lista de Materiais", peso: 3, tempoMedio: 1, categoria: "Planejamento" },
            { id: 5, nome: "Or√ßar Materiais", peso: 2, tempoMedio: 2, categoria: "Suprimentos" },
            { id: 6, nome: "Aguardar Entrega dos Materiais", peso: 5, tempoMedio: 10, categoria: "Suprimentos" },
            { id: 7, nome: "Montagem da M√°quina/Equipamento", peso: 8, tempoMedio: 5, categoria: "Produ√ß√£o" },
            { id: 8, nome: "Montagem do Quadro El√©trico", peso: 6, tempoMedio: 3, categoria: "El√©trica" },
            { id: 9, nome: "Teste El√©trico", peso: 4, tempoMedio: 1, categoria: "Qualidade" },
            { id: 10, nome: "Teste Mec√¢nico", peso: 4, tempoMedio: 1, categoria: "Qualidade" },
            { id: 11, nome: "Pintura/Zincagem (se aplicar)", peso: 3, tempoMedio: 3, categoria: "Acabamento" },
            { id: 12, nome: "Montagem Final", peso: 6, tempoMedio: 2, categoria: "Produ√ß√£o" },
            { id: 13, nome: "Teste Final", peso: 5, tempoMedio: 1, categoria: "Qualidade" },
            { id: 14, nome: "Embalagem", peso: 2, tempoMedio: 1, categoria: "Expedi√ß√£o" },
            { id: 15, nome: "Envio de Documenta√ß√£o", peso: 3, tempoMedio: 1, categoria: "Documenta√ß√£o" },
            { id: 16, nome: "Envio de Laudo (quando aplic√°vel)", peso: 2, tempoMedio: 2, categoria: "Documenta√ß√£o" },
            { id: 17, nome: "Trabalho em Campo", peso: 25, tempoMedio: 7, categoria: "Campo" }, // ETAPA MAIS CR√çTICA
            { id: 18, nome: "Expedi√ß√£o", peso: 4, tempoMedio: 1, categoria: "Log√≠stica" },
            { id: 19, nome: "Entrega", peso: 5, tempoMedio: 2, categoria: "Log√≠stica" },
            { id: 20, nome: "Faturamento", peso: 3, tempoMedio: 1, categoria: "Financeiro" } // 100% quando chega aqui
        ];

        // Dados de exemplo com datas reais para an√°lise de produtividade
        let projetos = [
            { 
                id: 1, 
                nome: "UFI", 
                cliente: "Cliente UFI", 
                etapaAtual: 20, // FATURAMENTO = 100%
                status: "Conclu√≠do",
                responsavel: "Junior, Fabiano", 
                temLaudo: true,
                prazoFinal: "2025-07-30",
                dataCriacao: "2025-06-01", // 59 dias para completar
                dataConclusao: "2025-07-28", // Conclu√≠do 2 dias antes do prazo
                observacoes: "Projeto conclu√≠do com sucesso"
            },
            { 
                id: 2, 
                nome: "PROJ_23", 
                cliente: "Cliente B", 
                etapaAtual: 8, // 60% de progresso
                status: "Em andamento", 
                responsavel: "Fabiano, Alexandre", 
                temLaudo: false,
                prazoFinal: "2025-08-30",
                dataCriacao: "2025-07-05", // 32 dias em andamento
                observacoes: "Em desenvolvimento"
            },
            { 
                id: 3, 
                nome: "PROJ_22", 
                cliente: "Cliente C", 
                etapaAtual: 12, // 82% de progresso
                status: "Em andamento", 
                responsavel: "Sidmar, F√°bio", 
                temLaudo: true,
                prazoFinal: "2025-08-10", // PRAZO PR√ìXIMO!
                dataCriacao: "2025-06-20", // 47 dias em andamento
                observacoes: "Aguardando testes finais"
            },
            { 
                id: 4, 
                nome: "PROJ_ATRASO", 
                cliente: "Cliente D", 
                etapaAtual: 6, // 38% de progresso
                status: "Em andamento", 
                responsavel: "Thiago", 
                temLaudo: false,
                prazoFinal: "2025-07-25", // ATRASADO!
                dataCriacao: "2025-06-10", // 57 dias em andamento
                observacoes: "Atraso na entrega de materiais"
            },
            { 
                id: 5, 
                nome: "PROJ_NOVO", 
                cliente: "Cliente E", 
                etapaAtual: 2, // 7% de progresso - rec√©m iniciado
                status: "Em andamento", 
                responsavel: "Eduardo Duarte", 
                temLaudo: true,
                prazoFinal: "2025-09-15",
                dataCriacao: "2025-08-01", // 5 dias em andamento
                observacoes: "Projeto rec√©m iniciado"
            }
        ];

        let proximoId = { projeto: 6 };
        let intervalosSync = [];
        let csvDataPreview = [];
        let chartsInstances = {};

        // ==================== C√ÅLCULOS DE ENGENHARIA DE PRODU√á√ÉO ====================

        function calcularProgressoComPeso(etapa) {
            const etapaInfo = etapasProcesso.find(e => e.id === etapa);
            if (!etapaInfo) return 0;
            
            let pesoAcumulado = 0;
            for (let i = 0; i < etapasProcesso.length && etapasProcesso[i].id <= etapa; i++) {
                pesoAcumulado += etapasProcesso[i].peso;
            }
            
            return Math.round(pesoAcumulado);
        }

        function calcularStatusPrazo(prazoFinal, statusAtual) {
            if (statusAtual === 'Conclu√≠do') {
                return 'Normal';
            }
            
            if (!prazoFinal) return 'Normal';
            
            const hoje = new Date();
            const prazo = new Date(prazoFinal);
            const diffTime = prazo - hoje;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            if (diffDays < 0) return 'Atrasado';
            if (diffDays <= 3) return 'Urgente';
            if (diffDays <= 7) return 'Pr√≥ximo';
            return 'Normal';
        }

        // ==================== M√âTRICAS DE PRODUTIVIDADE ====================

        function calcularProdutividade() {
            const total = projetos.length;
            const concluidos = projetos.filter(p => p.status === 'Conclu√≠do').length;
            
            if (total === 0) return { percent: 0, desc: 'Nenhum projeto' };
            
            const percent = Math.round((concluidos / total) * 100);
            return {
                percent: percent,
                desc: `${concluidos}/${total} finalizados`
            };
        }

        function calcularTempoMedio() {
            const projetosAtivos = projetos.filter(p => p.status !== 'Conclu√≠do' && p.dataCriacao);
            
            if (projetosAtivos.length === 0) {
                return { dias: 0, desc: 'Nenhum projeto ativo' };
            }
            
            const hoje = new Date();
            let totalTempo = 0;
            let totalEtapas = 0;
            
            projetosAtivos.forEach(projeto => {
                const dataCriacao = new Date(projeto.dataCriacao);
                const diasDecorridos = Math.ceil((hoje - dataCriacao) / (1000 * 60 * 60 * 24));
                const tempoMedioPorEtapa = diasDecorridos / projeto.etapaAtual;
                
                totalTempo += tempoMedioPorEtapa;
                totalEtapas++;
            });
            
            const tempMedio = Math.round(totalTempo / totalEtapas);
            return {
                dias: tempMedio,
                desc: 'Por etapa conclu√≠da'
            };
        }

        function calcularEficiencia() {
            const projetosComPrazo = projetos.filter(p => p.prazoFinal);
            
            if (projetosComPrazo.length === 0) {
                return { percent: 100, desc: 'Sem prazos definidos' };
            }
            
            let projetosNoPrazo = 0;
            
            projetosComPrazo.forEach(projeto => {
                const statusPrazo = calcularStatusPrazo(projeto.prazoFinal, projeto.status);
                if (projeto.status === 'Conclu√≠do' || statusPrazo === 'Normal' || statusPrazo === 'Pr√≥ximo') {
                    projetosNoPrazo++;
                }
            });
            
            const percent = Math.round((projetosNoPrazo / projetosComPrazo.length) * 100);
            return {
                percent: percent,
                desc: `${projetosNoPrazo}/${projetosComPrazo.length} no prazo`
            };
        }

        function contarAlertas() {
            const atrasados = projetos.filter(p => 
                p.status !== 'Conclu√≠do' && 
                calcularStatusPrazo(p.prazoFinal, p.status) === 'Atrasado'
            ).length;
            
            const urgentes = projetos.filter(p => 
                p.status !== 'Conclu√≠do' && 
                calcularStatusPrazo(p.prazoFinal, p.status) === 'Urgente'
            ).length;
            
            return {
                count: atrasados,
                desc: urgentes > 0 ? `${urgentes} urgentes` : 'Todos em dia'
            };
        }

        function contarPessoasAtivas() {
            const responsaveisAtivos = new Set();
            
            projetos.forEach(projeto => {
                if (projeto.status !== 'Conclu√≠do') {
                    const responsaveis = projeto.responsavel.split(',').map(r => r.trim());
                    responsaveis.forEach(resp => {
                        if (resp) responsaveisAtivos.add(resp);
                    });
                }
            });
            
            return responsaveisAtivos.size;
        }

        function extrairResponsaveisUnicos() {
            const responsaveisUnicos = new Set();
            
            projetos.forEach(projeto => {
                const responsaveis = projeto.responsavel.split(',').map(r => r.trim());
                responsaveis.forEach(resp => {
                    if (resp) responsaveisUnicos.add(resp);
                });
            });
            
            return Array.from(responsaveisUnicos).sort();
        }

        // ==================== GR√ÅFICOS COM CHART.JS ====================

        function criarGraficoStatus() {
            const ctx = document.getElementById('chart-status').getContext('2d');
            
            if (chartsInstances.status) {
                chartsInstances.status.destroy();
            }
            
            const statusCounts = {
                'Em andamento': projetos.filter(p => p.status === 'Em andamento').length,
                'Conclu√≠do': projetos.filter(p => p.status === 'Conclu√≠do').length,
                'Atrasado': projetos.filter(p => p.status !== 'Conclu√≠do' && calcularStatusPrazo(p.prazoFinal, p.status) === 'Atrasado').length,
                'Pendente': projetos.filter(p => p.status === 'Pendente').length
            };
            
            chartsInstances.status = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(statusCounts),
                    datasets: [{
                        data: Object.values(statusCounts),
                        backgroundColor: [
                            '#fbbf24', // Em andamento - amarelo
                            '#10b981', // Conclu√≠do - verde
                            '#ef4444', // Atrasado - vermelho
                            '#6b7280'  // Pendente - cinza
                        ],
                        borderRadius: 6,
                        borderSkipped: false,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.parsed.y + ' projetos';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { stepSize: 1 }
                        }
                    }
                }
            });
        }

        function criarGraficoEtapas() {
            const ctx = document.getElementById('chart-etapas').getContext('2d');
            
            if (chartsInstances.etapas) {
                chartsInstances.etapas.destroy();
            }
            
            // Agrupar projetos por faixas de etapas
            const faixasEtapas = {
                'In√≠cio (1-6)': projetos.filter(p => p.etapaAtual >= 1 && p.etapaAtual <= 6).length,
                'Meio (7-12)': projetos.filter(p => p.etapaAtual >= 7 && p.etapaAtual <= 12).length,
                'Final (13-18)': projetos.filter(p => p.etapaAtual >= 13 && p.etapaAtual <= 18).length,
                'Conclu√≠do (19-20)': projetos.filter(p => p.etapaAtual >= 19).length
            };
            
            chartsInstances.etapas = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(faixasEtapas),
                    datasets: [{
                        data: Object.values(faixasEtapas),
                        backgroundColor: [
                            '#3b82f6', // In√≠cio - azul
                            '#8b5cf6', // Meio - roxo
                            '#f59e0b', // Final - laranja
                            '#10b981'  // Conclu√≠do - verde
                        ],
                        borderRadius: 6,
                        borderSkipped: false,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.parsed.y + ' projetos';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { stepSize: 1 }
                        }
                    }
                }
            });
        }

        function criarGraficoTimeline() {
            const ctx = document.getElementById('chart-timeline').getContext('2d');
            
            if (chartsInstances.timeline) {
                chartsInstances.timeline.destroy();
            }
            
            // Simular dados de timeline (√∫ltimos 30 dias)
            const hoje = new Date();
            const labels = [];
            const dataIniciados = [];
            const dataConcluidos = [];
            
            for (let i = 29; i >= 0; i--) {
                const data = new Date();
                data.setDate(hoje.getDate() - i);
                labels.push(data.toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' }));
                
                // Simular dados (em produ√ß√£o, viria do banco de dados)
                dataIniciados.push(Math.floor(Math.random() * 3));
                dataConcluidos.push(Math.floor(Math.random() * 2));
            }
            
            chartsInstances.timeline = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Projetos Iniciados',
                        data: dataIniciados,
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'Projetos Conclu√≠dos',
                        data: dataConcluidos,
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { stepSize: 1 }
                        }
                    }
                }
            });
        }

        function criarGraficoResponsaveis() {
            const ctx = document.getElementById('chart-responsaveis').getContext('2d');
            
            if (chartsInstances.responsaveis) {
                chartsInstances.responsaveis.destroy();
            }
            
            // Contar projetos ativos por respons√°vel
            const responsaveisCarga = {};
            
            projetos.forEach(projeto => {
                if (projeto.status !== 'Conclu√≠do') {
                    const responsaveis = projeto.responsavel.split(',').map(r => r.trim());
                    responsaveis.forEach(resp => {
                        if (resp) {
                            responsaveisCarga[resp] = (responsaveisCarga[resp] || 0) + 1;
                        }
                    });
                }
            });
            
            const labels = Object.keys(responsaveisCarga);
            const data = Object.values(responsaveisCarga);
            
            chartsInstances.responsaveis = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: [
                            '#3b82f6', '#10b981', '#f59e0b', '#ef4444', 
                            '#8b5cf6', '#06b6d4', '#84cc16', '#f97316'
                        ],
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                padding: 15,
                                font: { size: 11 }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.parsed + ' projetos ativos';
                                }
                            }
                        }
                    }
                }
            });
        }

        function atualizarMetricasRelatorios() {
            const produtividade = calcularProdutividade();
            const tempoMedio = calcularTempoMedio();
            const eficiencia = calcularEficiencia();
            const alertas = contarAlertas();
            
            document.getElementById('produtividade-percent').textContent = produtividade.percent + '%';
            document.getElementById('produtividade-desc').textContent = produtividade.desc;
            
            document.getElementById('tempo-medio-valor').textContent = tempoMedio.dias + ' dias';
            
            document.getElementById('eficiencia-percent').textContent = eficiencia.percent + '%';
            document.getElementById('eficiencia-desc').textContent = eficiencia.desc;
            
            document.getElementById('alertas-count').textContent = alertas.count;
            document.getElementById('alertas-desc').textContent = alertas.desc;
        }

        // ==================== MODAIS E NAVEGA√á√ÉO ====================

        function mostrarRelatorios() {
            document.getElementById('modal-relatorios').classList.add('ativo');
            
            // Pequeno delay para garantir que o modal esteja vis√≠vel antes de criar os gr√°ficos
            setTimeout(() => {
                atualizarMetricasRelatorios();
                criarGraficoStatus();
                criarGraficoEtapas();
                criarGraficoTimeline();
                criarGraficoResponsaveis();
            }, 100);
        }

        function mostrarGerenciamento() {
            document.getElementById('modal-gerenciamento').classList.add('ativo');
            atualizarTabelaGerenciamentoProjetos();
            mostrarListaEtapas();
        }

        function mostrarTab(tabId) {
            // Esconder todas as tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Desativar todos os bot√µes
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Mostrar tab selecionada
            document.getElementById(tabId).classList.add('active');
            
            // Ativar bot√£o correspondente
            event.target.classList.add('active');
        }

        function atualizarTabelaGerenciamentoProjetos() {
            const tbody = document.getElementById('tabela-gerenciamento-projetos');
            tbody.innerHTML = '';

            projetos.forEach(projeto => {
                const statusPrazo = calcularStatusPrazo(projeto.prazoFinal, projeto.status);
                const statusExibido = projeto.status === 'Conclu√≠do' ? 'Conclu√≠do' : statusPrazo;
                const prazoFormatado = formatarPrazo(projeto.prazoFinal);

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-4 py-2 font-medium text-gray-900">${projeto.nome}</td>
                    <td class="px-4 py-2 text-gray-600">${projeto.cliente}</td>
                    <td class="px-4 py-2">
                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${obterCorStatus(statusExibido)}">
                            ${statusExibido}
                        </span>
                    </td>
                    <td class="px-4 py-2 text-sm">${prazoFormatado}</td>
                    <td class="px-4 py-2">
                        <button onclick="editarProjeto(${projeto.id})" class="text-blue-600 hover:text-blue-800 mr-2" title="Editar">‚úèÔ∏è</button>
                        <button onclick="excluirProjeto(${projeto.id})" class="text-red-600 hover:text-red-800" title="Excluir">üóëÔ∏è</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function mostrarListaEtapas() {
            const lista = document.getElementById('lista-etapas');
            lista.innerHTML = '';

            etapasProcesso.forEach((etapa, index) => {
                const div = document.createElement('div');
                div.className = 'flex justify-between items-center p-3 bg-gray-50 rounded border';
                div.innerHTML = `
                    <div>
                        <span class="font-medium">${etapa.id}. ${etapa.nome}</span>
                        <div class="text-xs text-gray-500">
                            Peso: ${etapa.peso}% | Tempo m√©dio: ${etapa.tempoMedio} dias | Categoria: ${etapa.categoria}
                        </div>
                    </div>
                    <div class="text-sm font-medium text-blue-600">${etapa.peso}%</div>
                `;
                lista.appendChild(div);
            });
        }

        // ==================== FUN√á√ïES DE A√á√ÉO DOS PROJETOS ====================
        
        function editarProjeto(id) {
            const projeto = projetos.find(p => p.id === id);
            if (!projeto) {
                mostrarNotificacao('Projeto n√£o encontrado', 'error');
                return;
            }
            
            mostrarNotificacao(`üîÑ Preparando edi√ß√£o do projeto: ${projeto.nome}`, 'pending');
            console.log('‚úèÔ∏è Editando projeto:', projeto);
        }

        function excluirProjeto(id) {
            const projeto = projetos.find(p => p.id === id);
            if (!projeto) {
                mostrarNotificacao('Projeto n√£o encontrado', 'error');
                return;
            }
            
            if (confirm(`Tem certeza que deseja excluir o projeto "${projeto.nome}"?`)) {
                projetos = projetos.filter(p => p.id !== id);
                salvarDados();
                atualizarInterface();
                atualizarTabelaGerenciamentoProjetos();
                mostrarNotificacao(`üóëÔ∏è Projeto "${projeto.nome}" exclu√≠do com sucesso`, 'success');
            }
        }

        function novorProjeto() {
            mostrarNotificacao('üîÑ Abrindo formul√°rio para novo projeto...', 'pending');
            console.log('‚ûï Fun√ß√£o de novo projeto');
        }

        // ==================== INTERFACE E RENDERIZA√á√ÉO ====================

        function atualizarEstatisticas() {
            const total = projetos.length;
            const concluidos = projetos.filter(p => p.status === 'Conclu√≠do').length;
            const andamento = projetos.filter(p => p.status === 'Em andamento').length;
            const pessoasAtivas = contarPessoasAtivas();
            
            const etapaMedia = total > 0 ? projetos.reduce((acc, p) => acc + p.etapaAtual, 0) / total : 0;
            
            const projetosComPrazo = projetos.filter(p => p.prazoFinal && p.status !== 'Conclu√≠do');
            let prazoMedio = 0;
            
            if (projetosComPrazo.length > 0) {
                const hoje = new Date();
                const totalDias = projetosComPrazo.reduce((acc, p) => {
                    const prazo = new Date(p.prazoFinal);
                    const diff = Math.ceil((prazo - hoje) / (1000 * 60 * 60 * 24));
                    return acc + Math.max(0, diff);
                }, 0);
                prazoMedio = Math.round(totalDias / projetosComPrazo.length);
            }

            document.getElementById('total-projetos').textContent = total;
            document.getElementById('projetos-concluidos').textContent = concluidos;
            document.getElementById('projetos-andamento').textContent = andamento;
            document.getElementById('pessoas-ativas').textContent = pessoasAtivas;
            document.getElementById('etapa-media').textContent = etapaMedia.toFixed(1);
            document.getElementById('prazo-medio').textContent = prazoMedio + ' dias';
        }

        function atualizarFiltros() {
            // Filtro de Etapas
            const selectEtapa = document.getElementById('filtro-etapa');
            selectEtapa.innerHTML = '<option value="todas">Todas as Etapas</option>';
            etapasProcesso.forEach(etapa => {
                const option = document.createElement('option');
                option.value = etapa.id;
                option.textContent = `${etapa.id}. ${etapa.nome}`;
                selectEtapa.appendChild(option);
            });

            // Filtro de Clientes
            const selectCliente = document.getElementById('filtro-cliente');
            selectCliente.innerHTML = '<option value="todos">Todos os Clientes</option>';
            const clientesUnicos = [...new Set(projetos.map(p => p.cliente))].sort();
            clientesUnicos.forEach(cliente => {
                const option = document.createElement('option');
                option.value = cliente;
                option.textContent = cliente;
                selectCliente.appendChild(option);
            });

            // Filtro de Respons√°veis
            const selectResponsavel = document.getElementById('filtro-responsavel');
            selectResponsavel.innerHTML = '<option value="todos">Todos os Respons√°veis</option>';
            const responsaveisUnicos = extrairResponsaveisUnicos();
            responsaveisUnicos.forEach(responsavel => {
                const option = document.createElement('option');
                option.value = responsavel;
                option.textContent = responsavel;
                selectResponsavel.appendChild(option);
            });
        }

        function renderizarTabela() {
            const projetosFiltrados = filtrarProjetos();
            document.getElementById('total-filtrados').textContent = projetosFiltrados.length;

            const tbody = document.getElementById('tabela-projetos');
            tbody.innerHTML = '';

            projetosFiltrados.forEach(projeto => {
                const etapa = etapasProcesso.find(e => e.id === projeto.etapaAtual);
                const progresso = calcularProgressoComPeso(projeto.etapaAtual);
                const statusPrazo = calcularStatusPrazo(projeto.prazoFinal, projeto.status);
                const prazoFormatado = formatarPrazo(projeto.prazoFinal);

                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50';
                
                if (statusPrazo === 'Atrasado' && projeto.status !== 'Conclu√≠do') {
                    row.className += ' bg-red-50';
                } else if (statusPrazo === 'Urgente') {
                    row.className += ' bg-yellow-50';
                }

                const statusExibido = projeto.status === 'Conclu√≠do' ? 'Conclu√≠do' : statusPrazo;
                const corStatus = projeto.status === 'Conclu√≠do' ? 'bg-green-100 text-green-800' : obterCorStatus(statusPrazo);

                row.innerHTML = `
                    <td class="px-3 py-4">
                        <div class="text-sm font-medium text-gray-900">${projeto.nome}</div>
                        <div class="text-xs text-gray-500">#${projeto.id}</div>
                    </td>
                    <td class="px-3 py-4">
                        <div class="text-sm text-gray-900">${projeto.cliente}</div>
                    </td>
                    <td class="px-3 py-4">
                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${obterCorEtapa(projeto.etapaAtual)}">
                            ${projeto.etapaAtual}. ${etapa ? etapa.nome.substring(0, 15) + '...' : 'Indefinida'}
                        </span>
                    </td>
                    <td class="px-3 py-4">
                        <div class="w-full bg-gray-200 rounded-full h-2 mb-1">
                            <div class="bg-blue-600 h-2 rounded-full" style="width: ${progresso}%"></div>
                        </div>
                        <span class="text-xs text-gray-500">${progresso}%</span>
                    </td>
                    <td class="px-3 py-4">
                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${corStatus}">
                            ${statusExibido}
                        </span>
                    </td>
                    <td class="px-3 py-4">
                        <div class="text-sm text-gray-900">${projeto.responsavel}</div>
                    </td>
                    <td class="px-3 py-4">
                        <div class="text-xs ${statusPrazo === 'Atrasado' && projeto.status !== 'Conclu√≠do' ? 'text-red-600 font-bold' : statusPrazo === 'Urgente' ? 'text-yellow-600 font-bold' : 'text-gray-900'}">
                            ${prazoFormatado}
                        </div>
                    </td>
                    <td class="px-3 py-4 text-center">
                        ${projeto.temLaudo ? '<span class="text-green-600 text-lg">‚úÖ</span>' : '<span class="text-gray-400 text-lg">‚ùå</span>'}
                    </td>
                    <td class="px-3 py-4">
                        <button onclick="editarProjeto(${projeto.id})" class="text-blue-600 hover:text-blue-800 mr-2 text-lg" title="Editar">‚úèÔ∏è</button>
                        <button onclick="excluirProjeto(${projeto.id})" class="text-red-600 hover:text-red-800 mr-2 text-lg" title="Excluir">üóëÔ∏è</button>
                        <button onclick="reenviarProjeto(${projeto.id})" class="text-green-600 hover:text-green-800 text-lg" title="Reenviar">üîÑ</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function filtrarProjetos() {
            const filtroEtapa = document.getElementById('filtro-etapa').value;
            const filtroStatus = document.getElementById('filtro-status').value;
            const filtroCliente = document.getElementById('filtro-cliente').value;
            const filtroResponsavel = document.getElementById('filtro-responsavel').value;
            const buscaProjeto = document.getElementById('busca-projeto').value.toLowerCase();
            
            return projetos.filter(projeto => {
                const statusReal = projeto.status === 'Conclu√≠do' ? 'Conclu√≠do' : calcularStatusPrazo(projeto.prazoFinal, projeto.status);
                
                const passaEtapa = filtroEtapa === 'todas' || projeto.etapaAtual.toString() === filtroEtapa;
                const passaStatus = filtroStatus === 'todos' || statusReal === filtroStatus;
                const passaCliente = filtroCliente === 'todos' || projeto.cliente === filtroCliente;
                
                const passaResponsavel = filtroResponsavel === 'todos' || 
                    projeto.responsavel.split(',').map(r => r.trim()).includes(filtroResponsavel);
                
                const passaBusca = !buscaProjeto || 
                    projeto.nome.toLowerCase().includes(buscaProjeto) ||
                    projeto.cliente.toLowerCase().includes(buscaProjeto) ||
                    projeto.responsavel.toLowerCase().includes(buscaProjeto);
                
                return passaEtapa && passaStatus && passaCliente && passaResponsavel && passaBusca;
            });
        }

        function reenviarProjeto(id) {
            const projeto = projetos.find(p => p.id === id);
            if (!projeto) {
                mostrarNotificacao('Projeto n√£o encontrado', 'error');
                return;
            }
            
            mostrarNotificacao(`üì§ Reenviando projeto "${projeto.nome}" para o servidor...`, 'pending');
            
            setTimeout(() => {
                mostrarNotifica√ß√£o(`‚úÖ Projeto "${projeto.nome}" reenviado com sucesso!`, 'success');
                console.log('üîÑ Projeto reenviado:', projeto);
            }, 1500);
        }

        // ==================== FUN√á√ïES UTILIT√ÅRIAS ====================

        function obterCorEtapa(etapa) {
            if (etapa <= 5) return 'bg-blue-100 text-blue-800';
            if (etapa <= 10) return 'bg-purple-100 text-purple-800';
            if (etapa <= 15) return 'bg-yellow-100 text-yellow-800';
            if (etapa <= 17) return 'bg-orange-100 text-orange-800';
            return 'bg-green-100 text-green-800';
        }

        function obterCorStatus(status) {
            switch (status) {
                case 'Conclu√≠do': return 'bg-green-100 text-green-800';
                case 'Em andamento': return 'bg-blue-100 text-blue-800';
                case 'Normal': return 'bg-gray-100 text-gray-800';
                case 'Pr√≥ximo': return 'bg-yellow-100 text-yellow-800';
                case 'Urgente': return 'bg-orange-100 text-orange-800';
                case 'Atrasado': return 'bg-red-100 text-red-800';
                case 'Pendente': return 'bg-gray-100 text-gray-800';
                default: return 'bg-gray-100 text-gray-800';
            }
        }

        function formatarPrazo(prazoFinal) {
            if (!prazoFinal) return 'N√£o definido';
            
            const prazo = new Date(prazoFinal);
            const hoje = new Date();
            const diffTime = prazo - hoje;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            const dataFormatada = prazo.toLocaleDateString('pt-BR');
            
            if (diffDays < 0) {
                return `${dataFormatada} (${Math.abs(diffDays)} dias atraso)`;
            } else if (diffDays === 0) {
                return `${dataFormatada} (Hoje!)`;
            } else {
                return `${dataFormatada} (${diffDays} dias)`;
            }
        }

        function fecharModal(modalId) {
            document.getElementById(modalId).classList.remove('ativo');
            
            // Destruir gr√°ficos quando fechar o modal de relat√≥rios para evitar vazamento de mem√≥ria
            if (modalId === 'modal-relatorios') {
                Object.values(chartsInstances).forEach(chart => {
                    if (chart && typeof chart.destroy === 'function') {
                        chart.destroy();
                    }
                });
                chartsInstances = {};
            }
        }

        // ==================== IMPORTA√á√ÉO CSV ====================

        function mostrarImportacaoCSV() {
            document.getElementById('modal-csv').classList.add('ativo');
            document.getElementById('csv-preview').style.display = 'none';
            document.getElementById('csv-file-input').value = '';
            csvDataPreview = [];
        }

        function processarCSV(file) {
            if (!file) return;
            
            console.log('üìÅ Processando CSV:', file.name);
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const csvContent = e.target.result;
                    const lines = csvContent.split(/\r?\n|\r/).filter(line => line.trim());
                    
                    if (lines.length < 2) {
                        mostrarNotificacao('‚ùå CSV precisa ter pelo menos 2 linhas (cabe√ßalho + dados)', 'error');
                        return;
                    }

                    // Detectar separador
                    const firstLine = lines[0];
                    let separator = ',';
                    const semicolonCount = (firstLine.match(/;/g) || []).length;
                    const commaCount = (firstLine.match(/,/g) || []).length;
                    const tabCount = (firstLine.match(/\t/g) || []).length;
                    
                    if (semicolonCount > commaCount && semicolonCount > tabCount) {
                        separator = ';';
                    } else if (tabCount > commaCount && tabCount > semicolonCount) {
                        separator = '\t';
                    }

                    console.log(`üîß Separador detectado: "${separator === '\t' ? 'TAB' : separator}"`);

                    // Processar cabe√ßalhos
                    const headers = lines[0].split(separator).map(h => h.trim().replace(/"/g, ''));
                    console.log('üìã CABE√áALHOS:', headers);

                    // Identificar colunas automaticamente
                    const columnMapping = identificarColunas(headers);
                    if (columnMapping.title === -1) {
                        mostrarNotificacao('‚ùå N√£o foi poss√≠vel identificar a coluna de t√≠tulo/tarefa', 'error');
                        return;
                    }

                    // Processar dados
                    csvDataPreview = [];
                    let sucessos = 0;

                    for (let i = 1; i < lines.length; i++) {
                        try {
                            const cols = lines[i].split(separator).map(col => col.trim().replace(/"/g, ''));
                            const titulo = cols[columnMapping.title] || '';
                            
                            if (titulo.trim()) {
                                const responsavelOriginal = cols[columnMapping.assignee] || '';
                                const responsavelLimpo = limparResponsavel(responsavelOriginal);
                                
                                const item = {
                                    original: {
                                        linha: i,
                                        titulo: titulo,
                                        responsavelOriginal: responsavelOriginal,
                                        prazo: cols[columnMapping.deadline] || '',
                                    },
                                    processado: {
                                        nome: titulo,
                                        responsavel: responsavelLimpo,
                                        cliente: extrairCliente(titulo),
                                        prazoFinal: converterData(cols[columnMapping.deadline] || ''),
                                        etapaAtual: 1,
                                        status: 'Em andamento',
                                        temLaudo: titulo.toLowerCase().includes('laudo'),
                                        observacoes: cols[columnMapping.description] || '',
                                        dataCriacao: new Date().toISOString().split('T')[0]
                                    },
                                    valido: true,
                                    alertas: []
                                };

                                if (!responsavelLimpo || responsavelLimpo === 'Junior') {
                                    item.alertas.push(`Respons√°vel "${responsavelOriginal}" convertido para "Junior"`);
                                }

                                csvDataPreview.push(item);
                                sucessos++;
                            }
                        } catch (lineError) {
                            console.error(`‚ùå Erro na linha ${i}:`, lineError);
                        }
                    }
                    
                    if (csvDataPreview.length > 0) {
                        mostrarPreviewCSV();
                    } else {
                        mostrarNotificacao('‚ùå Nenhum dado v√°lido encontrado no CSV', 'error');
                    }

                } catch (error) {
                    console.error('‚ùå Erro geral no processamento:', error);
                    mostrarNotificacao('‚ùå Erro ao processar CSV: ' + error.message, 'error');
                }
            };
            
            reader.readAsText(file, 'UTF-8');
        }

        function identificarColunas(headers) {
            const mapping = { title: -1, assignee: -1, deadline: -1, description: -1 };
            
            headers.forEach((header, index) => {
                const h = header.toLowerCase();
                if (h.includes('tarefa') || h.includes('titulo') || h.includes('nome') || h.includes('projeto')) {
                    mapping.title = index;
                }
                if (h.includes('responsavel') || h.includes('respons√°vel') || h.includes('atribuido')) {
                    mapping.assignee = index;
                }
                if (h.includes('prazo') || h.includes('deadline') || h.includes('data') || h.includes('vencimento')) {
                    mapping.deadline = index;
                }
                if (h.includes('descricao') || h.includes('descri√ß√£o') || h.includes('detalhes')) {
                    mapping.description = index;
                }
            });
            
            return mapping;
        }

        function limparResponsavel(responsavel) {
            if (!responsavel || responsavel.trim() === '') return 'Junior';
            
            const responsaveisValidos = [
                'Junior', 'Rodolfo', 'Eduardo Duarte', 'Cleiton Hardt', 
                'Thiago', 'Sidmar Vasconcelos', 'Fabiano Ramos', 
                'F√°bio Custodio', 'Vinicius Girotto', 'Jessica', 
                'Alexandre', 'Ulisses Peixoto'
            ];

            const mapeamento = {
                'junior': 'Junior', 'j√∫nior': 'Junior', 'carandina': 'Junior',
                'rodolfo': 'Rodolfo', 'eduardo': 'Eduardo Duarte',
                'cleiton': 'Cleiton Hardt', 'thiago': 'Thiago',
                'sidmar': 'Sidmar Vasconcelos', 'fabiano': 'Fabiano Ramos',
                'fabio': 'F√°bio Custodio', 'f√°bio': 'F√°bio Custodio',
                'vinicius': 'Vinicius Girotto', 'jessica': 'Jessica',
                'alexandre': 'Alexandre', 'ulisses': 'Ulisses Peixoto'
            };

            let nomeLimpo = responsavel.toString()
                .split(';')[0].split('-')[0].split('PO')[0]
                .replace(/\d+/g, '').replace(/[^\w\s√Ä-√ø]/g, ' ').trim();

            for (const nome of responsaveisValidos) {
                if (nomeLimpo.toLowerCase().includes(nome.toLowerCase())) {
                    return nome;
                }
            }

            const normalizado = nomeLimpo.toLowerCase();
            if (mapeamento[normalizado]) {
                return mapeamento[normalizado];
            }

            return nomeLimpo.split(' ')[0] || 'Junior';
        }

        function extrairCliente(titulo) {
            const match = titulo.match(/^([A-Z][A-Z\s&\-]+?)(?:\s*[-‚Äì‚Äî]|\s*\d)/);
            if (match) {
                const cliente = match[1].trim();
                if (cliente.length > 2 && cliente.length < 50) {
                    return cliente;
                }
            }
            
            const clientesConhecidos = ['UFI', 'ZF AUTOMOTIVE', 'KNORR', 'SIEMENS', 'BOSCH', 'VOLKSWAGEN', 'MERCEDES'];
            for (const cliente of clientesConhecidos) {
                if (titulo.toUpperCase().includes(cliente)) {
                    return cliente;
                }
            }
            
            return 'Cliente Geral';
        }

        function converterData(dataStr) {
            if (!dataStr || dataStr.trim() === '') {
                const futuro = new Date();
                futuro.setDate(futuro.getDate() + 7);
                return futuro.toISOString().split('T')[0];
            }

            const match1 = dataStr.match(/(\d{1,2})\/(\d{1,2})\/(\d{4})\s+(\d{1,2}):(\d{2})/);
            if (match1) {
                const date = new Date(
                    parseInt(match1[3]), parseInt(match1[2]) - 1, parseInt(match1[1]),
                    parseInt(match1[4]), parseInt(match1[5])
                );
                return date.toISOString().split('T')[0];
            }

            const match2 = dataStr.match(/(\d{1,2})\/(\d{1,2})\/(\d{4})/);
            if (match2) {
                const date = new Date(
                    parseInt(match2[3]), parseInt(match2[2]) - 1, parseInt(match2[1])
                );
                return date.toISOString().split('T')[0];
            }

            const date = new Date(dataStr);
            if (!isNaN(date.getTime())) {
                return date.toISOString().split('T')[0];
            }

            const futuro = new Date();
            futuro.setDate(futuro.getDate() + 7);
            return futuro.toISOString().split('T')[0];
        }

        function mostrarPreviewCSV() {
            const previewDiv = document.getElementById('csv-preview');
            const contentDiv = document.getElementById('csv-preview-content');
            
            let html = `<div class="text-sm font-medium mb-2">üìä ${csvDataPreview.length} itens processados:</div>`;
            
            csvDataPreview.slice(0, 10).forEach((item) => {
                const alertClass = item.alertas.length > 0 ? 'border-yellow-300 bg-yellow-50' : 'border-green-300 bg-green-50';
                html += `
                    <div class="p-2 mb-2 rounded border ${alertClass}">
                        <div class="font-medium text-sm">${item.processado.nome}</div>
                        <div class="text-xs text-gray-600">
                            üë§ ${item.original.responsavelOriginal} ‚Üí ${item.processado.responsavel} | 
                            üìÖ ${item.original.prazo} ‚Üí ${item.processado.prazoFinal} |
                            üè¢ ${item.processado.cliente}
                        </div>
                        ${item.alertas.length > 0 ? `<div class="text-xs text-yellow-600 mt-1">‚ö†Ô∏è ${item.alertas.join(', ')}</div>` : ''}
                    </div>
                `;
            });
            
            if (csvDataPreview.length > 10) {
                html += `<div class="text-xs text-gray-500 text-center mt-2">... e mais ${csvDataPreview.length - 10} itens</div>`;
            }
            
            contentDiv.innerHTML = html;
            previewDiv.style.display = 'block';
        }

        function confirmarImportacaoCSV() {
            if (csvDataPreview.length === 0) {
                mostrarNotificacao('‚ùå Nenhum dado para importar', 'error');
                return;
            }
            
            let importados = 0;
            
            csvDataPreview.forEach(item => {
                const projeto = {
                    id: proximoId.projeto++,
                    ...item.processado
                };
                
                projetos.push(projeto);
                importados++;
            });
            
            salvarDados();
            atualizarInterface();
            fecharModal('modal-csv');
            
            let mensagem = `‚úÖ ${importados} projetos importados com sucesso!`;
            mostrarNotificacao(mensagem, 'success');
            
            if (configAPI.syncAuto) {
                setTimeout(() => sincronizarComAPI(), 1000);
            }
        }

        function cancelarImportacaoCSV() {
            csvDataPreview = [];
            document.getElementById('csv-preview').style.display = 'none';
            document.getElementById('csv-file-input').value = '';
        }

        // ==================== SINCRONIZA√á√ÉO AUTOM√ÅTICA ====================

        async function sincronizarComAPI() {
            if (!configAPI.url || !configAPI.token) {
                mostrarNotificacao('Configure a API antes de sincronizar', 'error');
                return false;
            }

            mostrarNotificacao('üîÑ Sincronizando...', 'pending');
            
            try {
                const response = await fetch(`${configAPI.url}/sync`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': configAPI.token
                    },
                    body: JSON.stringify({
                        projetos,
                        timestamp: new Date().toISOString()
                    })
                });

                if (response.ok) {
                    const dadosSync = await response.json();
                    
                    if (dadosSync.success) {
                        configAPI.ultimaSync = new Date().toISOString();
                        salvarDados();
                        
                        mostrarNotificacao('‚úÖ Sincroniza√ß√£o conclu√≠da', 'success');
                        document.getElementById('ultima-sync').textContent = new Date().toLocaleTimeString();
                        document.getElementById('status-conexao').innerHTML = 'üü¢ Online';
                        
                        return true;
                    } else {
                        throw new Error(dadosSync.message || 'Erro na sincroniza√ß√£o');
                    }
                } else {
                    throw new Error(`Erro ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                mostrarNotificacao('‚ùå Erro na sincroniza√ß√£o: ' + error.message, 'error');
                document.getElementById('status-conexao').innerHTML = 'üî¥ Offline';
                console.error('‚ùå Erro na sincroniza√ß√£o:', error);
                return false;
            }
        }

        function sincronizarManual() {
            sincronizarComAPI();
        }

        // ==================== PERSIST√äNCIA E BACKUP ====================

        function salvarDados() {
            const dados = {
                projetos,
                configAPI,
                proximoId,
                timestamp: new Date().toISOString(),
                versao: '4.0-relatorios'
            };
            
            try {
                window.newTechData = dados;
                console.log('üíæ Dados salvos em mem√≥ria');
                return true;
            } catch (error) {
                console.error('‚ùå Erro ao salvar dados:', error);
                return false;
            }
        }

        function carregarDados() {
            try {
                if (window.newTechData) {
                    const dados = window.newTechData;
                    
                    if (dados.projetos) projetos.length = 0, projetos.push(...dados.projetos);
                    if (dados.configAPI) Object.assign(configAPI, dados.configAPI);
                    if (dados.proximoId) Object.assign(proximoId, dados.proximoId);
                    
                    console.log('üìÇ Dados carregados da mem√≥ria');
                    return true;
                }
            } catch (error) {
                console.error('‚ùå Erro ao carregar dados:', error);
            }
            return false;
        }

        function backupDados() {
            const backup = {
                projetos,
                etapasProcesso,
                configAPI: { ...configAPI, token: '' },
                proximoId,
                versao: '4.0-relatorios',
                timestamp: new Date().toISOString(),
                metadados: {
                    totalProjetos: projetos.length,
                    projetosConcluidos: projetos.filter(p => p.status === 'Conclu√≠do').length,
                    pessoasAtivas: contarPessoasAtivas(),
                    produtividade: calcularProdutividade(),
                    eficiencia: calcularEficiencia()
                }
            };
            
            const dataStr = JSON.stringify(backup, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `newtech_backup_relatorios_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            mostrarNotificacao('üíæ Backup com relat√≥rios criado com sucesso!', 'success');
        }

        // ==================== NOTIFICA√á√ïES ====================

        function mostrarNotificacao(mensagem, tipo = 'success') {
            const indicator = document.getElementById('sync-indicator');
            indicator.textContent = mensagem;
            indicator.className = `sync-indicator sync-${tipo} fade-in`;
            indicator.style.display = 'block';
            
            console.log(`üîî ${tipo.toUpperCase()}: ${mensagem}`);
            
            setTimeout(() => {
                indicator.className = `sync-indicator sync-${tipo} fade-out`;
                setTimeout(() => {
                    indicator.style.display = 'none';
                }, 300);
            }, tipo === 'pending' ? 5000 : 3000);
        }

        // ==================== INTERFACE PRINCIPAL ====================

        function atualizarInterface() {
            atualizarFiltros();
            renderizarTabela();
            atualizarEstatisticas();
            
            if (configAPI.ultimaSync) {
                document.getElementById('ultima-sync').textContent = 
                    new Date(configAPI.ultimaSync).toLocaleTimeString();
            }
            
            document.getElementById('intervalo-sync').textContent = configAPI.intervaloMinutos + ' min';
        }

        // ==================== DRAG & DROP PARA CSV ====================

        function configurarDragDrop() {
            const uploadArea = document.getElementById('csv-upload-area');
            
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                uploadArea.addEventListener(eventName, preventDefaults, false);
            });

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            ['dragenter', 'dragover'].forEach(eventName => {
                uploadArea.addEventListener(eventName, highlight, false);
            });

            ['dragleave', 'drop'].forEach(eventName => {
                uploadArea.addEventListener(eventName, unhighlight, false);
            });

            function highlight(e) {
                uploadArea.classList.add('drag-over');
            }

            function unhighlight(e) {
                uploadArea.classList.remove('drag-over');
            }

            uploadArea.addEventListener('drop', handleDrop, false);

            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                
                if (files.length > 0) {
                    processarCSV(files[0]);
                }
            }
        }

        // ==================== INICIALIZA√á√ÉO ====================

        function inicializar() {
            console.log('üöÄ Inicializando Dashboard New Tech v4.0 - RELAT√ìRIOS DE PRODUTIVIDADE');
            
            carregarDados();
            atualizarInterface();
            configurarDragDrop();
            
            if (configAPI.ultimaSync) {
                document.getElementById('ultima-sync').textContent = 
                    new Date(configAPI.ultimaSync).toLocaleTimeString();
            }
            
            // Auto-save peri√≥dico
            setInterval(() => {
                salvarDados();
            }, 30000);

            setTimeout(() => {
                mostrarNotificacao('‚úÖ Dashboard New Tech carregado com Relat√≥rios de Produtividade!', 'success');
            }, 500);
            
            console.log('‚úÖ RECURSOS IMPLEMENTADOS:');
            console.log('  üìä Sistema completo de m√©tricas de produtividade');
            console.log('  ‚è±Ô∏è C√°lculo real de tempo m√©dio por etapa');
            console.log('  ‚ö° An√°lise de efici√™ncia baseada em prazos');
            console.log('  üìà Gr√°ficos interativos com Chart.js');
            console.log('  üîç An√°lise detalhada de engenharia de produ√ß√£o');
            console.log('  ‚öôÔ∏è Gerenciamento completo de projetos e etapas');
            console.log('  üíæ Sistema de backup com metadados de produtividade');
        }

        document.addEventListener('DOMContentLoaded', inicializar);
        
        window.addEventListener('beforeunload', function() {
            salvarDados();
        });

        console.log('üîß Sistema NewTech Dashboard v4.0 - RELAT√ìRIOS DE PRODUTIVIDADE');
        console.log('üìä M√©tricas reais baseadas em Engenharia de Produ√ß√£o');
        console.log('‚è±Ô∏è Tempo m√©dio: dias decorridos / etapa atual');
        console.log('‚ö° Efici√™ncia: projetos no prazo / total ativos');
        console.log('üìà Produtividade: projetos conclu√≠dos / total');
        console.log('üéØ Sistema completo de an√°lises e gr√°ficos');
    </script>
</body>
</html>
